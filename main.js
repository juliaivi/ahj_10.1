!function(){"use strict";var t={text:"Что-то пошло не так",discrition:"К сожалению нам не удалось определить ваше местоположение. Пожалуйста дайте согласие на использование геолокации, либо введите координаты вручную. "},i={text:"Неправильные координаты",discrition:'Введите свои координаты еще раз, либо дайте разрешение на использование геолокации! Пример правильных координат - "53.234, 123.5654"'};function e(t,i,e){const o=document.querySelector(".timeline"),n=`\n                    <div class="timeline__item">\n                      <div class="timeline__item__data">${function(){const t=new Date,i=t.getHours();let e=t.getMinutes(),o=t.getDate(),n=t.getMonth()+1;return e=e<10?`0${e}`:e,o=o<10?`0${o}`:o,n=n<10?`0${n}`:n,`${i}:${e} ${o}.${n}.${t.getFullYear()}`}()}</div>\n                      <div class="timeline__item__content">${t}</div>\n                      <div class="timeline__item__geo">\n                          <span class="geo_data">[${i}, ${e}]</span>\n                          <span class="geo_icon"> \n                              <img class="icon">\n                          </span>\n                    </div>\n    `;o.insertAdjacentHTML("beforeend",n)}class o{constructor(){this.latitude=void 0,this.longitude=void 0,this.formInputValue=null,this.popup=document.querySelector(".popup"),this.popupInput=document.querySelector(".popup__input"),this.popupTitle=document.querySelector(".popup__title"),this.popupDiscrition=document.querySelector(".popup__discrition"),this.popupBtns=document.querySelector(".popup__btns"),this.formInput=document.querySelector(".form__input"),this.geo=!1}locate(){navigator.geolocation&&navigator.geolocation.getCurrentPosition((t=>{this.latitude=t.coords.latitude,this.longitude=t.coords.longitude;const i=this.formInput.value.trim();this.geo=!0,i&&(e(i,this.latitude,this.longitude),this.formInput.value="")}),(t=>{this.popup.classList.contains("d__none")&&this.popup.classList.remove("d__none"),this.popupBtns.addEventListener("click",(t=>this.onClick(t))),console.log(t)}))}onClick(i){i.preventDefault(),this.formInputValue=this.formInput.value.trim();const e=this.popupInput.value,o=/^\[?-?([1-8]?\d(\.\d{1,18})?|90(\.\d{1,18})?),\s?-?((?:1[0-7]|[1-9])?\d(?:\.\d{1,18})?|180(?:\.0{1,18})?)\]?$/.test(e);i.target.classList.contains("btn__ok")&&""!==this.formInputValue&&this.checkOk(o),i.target.classList.contains("btn__cansel")&&(this.popup.classList.add("d__none"),this.popupTitle.textContent=t.text,this.popupDiscrition.textContent=t.discrition),this.popupInput.value=""}getCoords(t){const i=t.replace(/^\[/,"").replace(/\]$/,"").split(",");this.latitude=i[0],this.longitude=i[1]}checkOk(o){o?(this.getCoords(this.popupInput.value),this.popup.classList.add("d__none"),this.formInputValue&&(e(this.formInputValue,this.latitude,this.longitude),this.formInput.value="",this.latitude=null,this.longitude=null,this.popupTitle.textContent=t.text,this.popupDiscrition.textContent=t.discrition)):(this.popupTitle.textContent=i.text,this.popupDiscrition.textContent=i.discrition)}}(new class{constructor(){this.container=document.querySelector(".container"),this.form=this.container.querySelector(".form"),this.formInput=this.form.querySelector(".form__input"),this.popup=document.querySelector(".popup")}init(){this.locationDefine=new o,this.form.addEventListener("submit",(t=>this.onSubmit(t)))}onSubmit(t){t.preventDefault();const i=this.formInput.value.trim();i&&(this.locationDefine.locate(),this.locationDefine.latitude&&this.locationDefine.longitude?(e(i,this.locationDefine.latitude,this.locationDefine.longitude),this.formInput.value=""):this.popup.classList.contains("d__none")&&this.locationDefine.geo&&this.popup.classList.remove("d__none"))}}).init()}();